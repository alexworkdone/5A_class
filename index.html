<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Розклад - 7 клас</title>

  <link rel="stylesheet" href="css/owl.carousel.min.css" />
  <link rel="stylesheet" href="css/style.css" />
</head>

<body>
  <div class="container">
    <h2>Error<br />Щось пішло кудись і не так...</h2>
    <h1>
      Розклад уроків 7-A класу
    </h1>

    <div class="flex">
      <div class="table-day">
        <div class="item-day item-header">Номер уроку</div>
        <div id="less_1" class="item-day">
          <span id="time_start_1" class="time start">8:50</span>
          1 урок ONLINE
          <span id="time_end_1" class="time end">9:35</span>
        </div>
        <div id="less_2" class="item-day">
          <span id="time_start_2" class="time start">9:40</span>
          2 урок ONLINE
          <span id="time_end_2" class="time end">10:25</span>
        </div>
        <div id="less_3" class="item-day">
          <span id="time_start_3" class="time start">10:30</span>
          3 урок ONLINE
          <span id="time_end_3" class="time end">11:15</span>
        </div>
        <div id="less_4" class="item-day bg-multicolor">
          <span id="time_start_4" class="time start">11:15</span>
          Ідти до школи
          <span id="time_end_4" class="time end">13:00</span>
        </div>
        <div id="less_5" class="item-day">
          <span id="time_start_5" class="time start">13:00</span>
          4 урок
          <span id="time_end_5" class="time end">13:45</span>
        </div>
        <div id="less_6" class="item-day">
          <span id="time_start_6" class="time start">14:00</span>
          5 урок
          <span id="time_end_6" class="time end">14:45</span>
        </div>
        <div id="less_7" class="item-day">
          <span id="time_start_7" class="time start">14:50</span>
          6 урок
          <span id="time_end_7" class="time end">15:35</span>
        </div>
        <div id="less_8" class="item-day">
          <span id="time_start_8" class="time start">15:45</span>
          7 урок
          <span id="time_end_8" class="time end">16:30</span>
        </div>
        <div id="less_9" class="item-day">
          <span id="time_start_9" class="time start">16:40</span>
          8 урок
          <span id="time_end_9" class="time end">17:25</span>
        </div>
      </div>

      <div class="owl-carousel table-slider">
        <div class="table-col" data-day="1">
          <div class="table-item item-header item-header-title">Понеділок</div>
          <div class="table-item">
            Технології
            <div class="name">Інна Володимирівна</div>
          </div>
          <div class="table-item">
            Музичне мистецтво
            <div class="name">Богдана Миколаївна</div>
          </div>
          <div class="table-item">
            ---
          </div>
          <div class="table-item bg-multicolor">До школи!</div>
          <div class="table-item">
            Історія України
            <div class="name">Наталія Федорівна</div>
          </div>
          <div class="table-item">
            Алгебра
            <a href="algebra7.html" class="link-mat">IsterO</a>
            <div class="name">Лідія Григорівна</div>
          </div>
          <div class="table-item">
            Англійська мова
            <div class="name">Віта Андріївна</div>
          </div>
          <div class="table-item">
            Географія
            <div class="name">Наталія Миколаївна</div>
          </div>
          <div class="table-item">
            Фізична культура
            <div class="name">Ярослава Миколаївна</div>
          </div>
        </div>

        <div class="table-col" data-day="2">
          <div class="table-item item-header item-header-title">Вівторок</div>
          <div class="table-item">
            ---
          </div>
          <div class="table-item">
            ---
          </div>
          <div class="table-item">
            ---
          </div>
          <div class="table-item bg-multicolor">До школи!</div>
          <div class="table-item">
            Зарубіжна література
            <div class="name">Леся Павлівна</div>
          </div>
          <div class="table-item">
            Біологія
            <div class="name">Світлана Олексіївна</div>
          </div>
          <div class="table-item">
            Геометрія
            <div class="name">Лідія Григорівна</div>
          </div>
          <div class="table-item">
            Алгебра
            <a href="algebra7.html" class="link-mat">IsterO</a>
            <div class="name">Лідія Григорівна</div>
          </div>
          <div class="table-item">
            Всесвітня історія
            <div class="name">Наталія Федорівна</div>
          </div>
        </div>

        <div class="table-col" data-day="3">
          <div class="table-item item-header item-header-title">Середа</div>
          <div class="table-item">
            ---
          </div>
          <div class="table-item">
            ---
          </div>
          <div class="table-item">
            Українська література
            <div class="name">Інна Володимирівна</div>
          </div>
          <div class="table-item bg-multicolor">До школи!</div>
          <div class="table-item">
            Геометрія
            <div class="name">Лідія Григорівна</div>
          </div>
          <div class="table-item">
            Українська мова
            <div class="name">Інна Володимирівна</div>
          </div>
          <div class="table-item">
            Географія
            <div class="name">Наталія Миколаївна</div>
          </div>
          <div class="table-item">
            Фізична культура
            <div class="name">Ярослава Миколаївна</div>
          </div>
          <div class="table-item">
            Зарубіжна література
            <div class="name">Леся Павлівна</div>
          </div>
        </div>

        <div class="table-col" data-day="4">
          <div class="table-item item-header item-header-title">Четвер</div>
          <div class="table-item">
            ---
          </div>
          <div class="table-item">
            ---
          </div>
          <div class="table-item">
            Українська література
            <div class="name">Інна Володимирівна</div>
          </div>
          <div class="table-item bg-multicolor">До школи!</div>
          <div class="table-item">
            Фізика
            <div class="name">Аліна Григорівна</div>
          </div>
          <div class="table-item">
            ---
          </div>
          <div class="table-item">
            Хімія
            <div class="name">Олена Вікторівна</div>
          </div>
          <div class="table-item">
            Українська мова
            <div class="name">Інна Володимирівна</div>
          </div>
          <div class="table-item">
            Українська мова
            <div class="name">Інна Володимирівна</div>
          </div>
        </div>

        <div class="table-col" data-day="5">
          <div class="table-item item-header item-header-title">П'ятниця</div>
          <div class="table-item">
            ---
          </div>
          <div class="table-item">
            Здоров'я, безпека і добробут
            <div class="name">Олена Вікторівна</div>
          </div>
          <div class="table-item">
            ---
          </div>
          <div class="table-item bg-multicolor">До школи!</div>
          <div class="table-item">
            Біологія
            <div class="name">Світлана Олексіївна</div>
          </div>
          <div class="table-item">
            Фізична культура
            <div class="name">Ярослава Миколаївна</div>
          </div>
          <div class="table-item">
            Фізика
            <div class="name">Аліна Григорівна</div>
          </div>
          <div class="table-item">
            ---
          </div>
          <div class="table-item">
            Інформатика
            <div class="name">Олександр Іванович</div>
          </div>
        </div>
      </div>
    </div>

    <!-- <a class="get-home-work" href="dz.html">Показати домашне завдання</a> -->

    <div style="height: 50px;"></div>
  </div>

  <script src="js/jquery-3.3.1.min.js"></script>
  <script src="js/owl.carousel.min.js"></script>

  <script>
    $(document).ready(function () {
      var oneJan = new Date(new Date().getFullYear(), 0, 1);
      var numberOfDays = Math.floor((new Date() - oneJan) / (24 * 60 * 60 * 1000));
      var result = Math.ceil((new Date().getDay() + 6 + numberOfDays) / 7);

      const arrTime = $("[id^='less']");

      const timeLesson = {
        start: ["8:50", "9:40", "10:30", "11:15", "13:00", "14:00", "14:50", "15:45", "16:40"],
        end: ["9:35", "10:25", "11:15", "13:00", "13:45", "14:45", "15:35", "16:30", "17:25"],
      };

      const carousel = $(".table-slider");

      function callBack(event) {
        setTimeout((item) => {
          let nowTimeLesson = JSON.parse(JSON.stringify(timeLesson));

          nowTimeLesson.start.pop();
          nowTimeLesson.end.pop();

          $.each(arrTime, (index, item) => {
            $(item).find("[id^='time_start']").html(nowTimeLesson.start[index]);
            $(item).find("[id^='time_end']").html(nowTimeLesson.end[index]);
          });

          drowFirstLesson();
        }, 100);
      }

      carousel.owlCarousel({
        loop: true,
        dots: false,
        merge: true,
        nav: false,
        stagePadding: 10,
        margin: 10,
        onInitialized: callBack,
        onChanged: callBack,
        responsive: {
          1200: {
            items: 5,
          },
          1000: {
            items: 4,
          },
          800: {
            items: 3,
          },
          600: {
            items: 2,
          },
          0: {
            items: 1,
          },
        },
      });

      const nowDay = new Date();
      const nowIndexDay = nowDay.getDay();
      const nowTime = nowDay.getTime();
      const nowHours = nowDay.getHours();
      const nowMinutes = nowDay.getMinutes();
      const LessonFinalTime = new Date().setHours(18, 10, 0, 0);

      // Проскроллить к расписанию сегодняшнего дня
      function scrollToDay(index) {
        carousel.trigger("to.owl.carousel", index);
      }

      let index = nowIndexDay >= 2 && nowIndexDay <= 5 ? nowIndexDay - 1 : 0;
      scrollToDay(index);

      // После инициализации назначить клас на сегодняшний день
      $(`[data-day='${nowIndexDay}']`).each((index, item) => {
        $(item)[0].classList.add("today_item");
      });

      // Закрасить все прошедшие уроки
      function endLessonToDay(itemStart, itemEnd, numLesson) {
        const [tsh, tsm] = $(itemStart).html().split(":");
        const [teh, tem] = $(itemEnd).html().split(":");

        const LessonStartTime = new Date().setHours(tsh, tsm, 0, 0);
        const LessonEndTime = new Date().setHours(teh, tem, 0, 0);

        if (LessonEndTime <= nowTime) {
          itemEnd.parent(".item-day")[0].classList.add("bg-time");
        } else if (LessonStartTime <= nowTime && nowTime <= LessonEndTime) {
          const fullTimeLesson = LessonEndTime - LessonStartTime;
          const realTimeLesson = nowTime - LessonStartTime;
          const persentRealTimeLesson = (realTimeLesson * 100) / fullTimeLesson;
          $("head").append(`<style>#less_${numLesson}:before{height:${persentRealTimeLesson}%;}</style>`);
        }
      }

      if (nowTime >= LessonFinalTime) {
        scrollToDay(nowIndexDay);
      } else {
        $.each(arrTime, (index, item) => {
          const itemStart = $(item).find("[id^='time_start']");
          const itemEnd = $(item).find("[id^='time_end']");

          endLessonToDay(itemStart, itemEnd, index + 1);
        });
      }

      // Найти начало первого урока
      function drowFirstLesson() {
        const itemFirstStart = $("#time_start_1");
        const [tfsh, tfsm] = $(itemFirstStart).html().split(":");
        const firstLessonStartTime = new Date().setHours(tfsh, tfsm, 0, 0);

        if (firstLessonStartTime >= nowTime) {
          itemFirstStart[0].classList.add("danger-animate");
        }
      }

      setTimeout(function () {
        location.reload();
      }, 300000);
    });
  </script>
</body>

</html>